/**
 * Calendar App
 *
 * @copyright 2020 Georg Ehrke <oc.list@georgehrke.com>
 *
 * @author Georg Ehrke
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU AFFERO GENERAL PUBLIC LICENSE for more details.
 *
 * You should have received a copy of the GNU Affero General Public
 * License along with this library.  If not, see <http://www.gnu.org/licenses/>.
 *
 */

/** Override some FullCalendar CSS vars: */
:root {
	--fc-theme-standard-border-color: var(--color-border) !important;
	--fc-theme-standard-muted-bg-color: var(--color-background-dark) !important;
}

/** Do not allow selecting text inside calendar-grid */
.fc {
	user-select: none;
}

.fc-view.fc-timeGridDay-view {
	.fc-today {
		background: var(--color-main-background) !important;
	}
}

.fc th,
.fc .fc-axis,
.fc-day-grid-event .fc-time,
.fc-ltr .fc-basic-view .fc-day-number,
.fc-ltr .fc-basic-view .fc-week-number,
.fc-time-grid-event .fc-time {
	opacity: .8;
	font-size: 80%;
	font-weight: normal;
}

.fc-basic-view .fc-day-top .fc-week-number {
	background-color: var(--color-border);
	color: var(--color-main-text);
}

// Center date in month view cell
.fc-day-top {
	text-align: center;

	.fc-day-number {
		float: none !important;
		display: inline-block;
	}
}

.fc-day-number.fc-other-month {
	opacity: .1 !important;
}

.fc td.fc-widget-header {
	border-top: none;
}

.fc th,
.fc td {
	border-left: none;
	border-bottom: none;
}

/* border styles for grid, highlight full-hour horizontal lines */

.fc-unthemed tr th,
.fc-unthemed tr td {
	border-color: var(--color-border);
	//border-top-color: var(--color-border-dark);
}

.fc-unthemed tr:nth-child(even) td {
	border-top-color: var(--color-border-dark);
}

/* properly size events */
.fc-event {
	font-size: 13px;
	line-height: initial;
	padding-left: 3px;
	min-height: 16px;
}

.fc-axis,
.fc-day-header {
	font-size: 100%;
	opacity: .5;
}

.fc td.fc-day.nc-calendar-fc-day-of-weekend {
	background-color: var(--color-background-dark);
}

.fc table {
	white-space: inherit !important;
}

.fc .fc-today {
	opacity: 1;
}

.fc-state-highlight.fc-day-number,
.fc tbody tr,
.fc tbody tr:hover,
.fc tbody tr:focus {
	background: transparent !important;
}

.fc .fc-divider {
	background: var(--color-border) !important;
	border-color: var(--color-border) !important;
}
/** Custom styles for today */
.fc-day-today {
	background: var(--color-main-background) !important;

	.fc-daygrid-day-number {
		background: var(--color-primary);
		color: var(--color-primary-text);
		border-radius: 50%;
		margin: 3px 3px 0 0;
		width: 24px;
		height: 24px;
		text-align: center;
		font-weight: bold !important;
		box-sizing: border-box !important;
	}

	.fc-col-header-cell-cushion {
		background-color: var(--color-primary);
		border-radius: var(--border-radius-pill);
		padding: 2px 6px;
		color: var(--color-primary-text);
		font-weight: bold;
	}

	&.nc-calendar-fc-day-of-weekend:not(.fc-day-header) {
		background-color: var(--color-background-hover) !important;
	}
}

/** Weekend styles */
.fc td.fc-day.nc-calendar-fc-day-of-weekend {
	background-color: var(--color-background-hover);
}

/** Week numbers in day grid view */
.fc-daygrid-week-number {
	background-color: var(--color-background-dark) !important;
	color: var(--color-text-maxcontrast) !important;
}

.nc-calendar-fc-day-of-weekend {
	.fc-daygrid-week-number {
		background-color: var(--color-background-dark) !important;
		color: var(--color-text-maxcontrast) !important;
	}
}

/** More events popover */
.fc-popover.fc-more-popover {
	border-color: var(--color-border-dark) !important;

	.fc-popover-header {
		background-color: var(--color-background-dark) !important;
	}

	.fc-popover-body {
		background-color: var(--color-main-background) !important;
	}
}

/** Remove grey border around entire calendar-grid */
.fc-theme-standard .fc-scrollgrid {
	border: none !important;
}

/** Fix text-color for timed events in day-grid views */
.fc-daygrid-dot-event {
	color: var(--color-main-text) !important;
}

/** Style for tentative and cancelled events + completed tasks */
.fc-event-nc-task-completed,
.fc-event-nc-tentative,
.fc-event-nc-cancelled {
	opacity: .5;
}

.fc-event-nc-task-completed,
.fc-event-nc-cancelled {
	.fc-event-title {
		text-decoration: line-through !important;
	}
}

/** Styles for tasks */
.fc-event-nc-task {
	.icon-event-task {
		display: inline-block;
		vertical-align: bottom;
		border: 1px solid black;
		border-radius: 1px;
		margin: 2px 3px 2px 1px;
		min-width: 9px;
		min-height: 9px;
		&--light {
			border-color: #ffffff;
		}
		&--checked--light {
			background-size: 9px;
			@include icon-color('checkmark', 'actions', '#ffffff', 1, true);
		}
		&--dark {
			border-color: #000000;
		}
		&--checked--dark {
			background-size: 9px;
			@include icon-color('checkmark', 'actions', '#000000', 1, true);
		}
	}
}

/** Nextcloud has standard hover styles for tables, disable them for FullCalendar */
.fc-state-highlight.fc-day-number,
.fc tbody tr,
.fc tbody tr:hover,
.fc tbody tr:focus {
	background: transparent !important;
}

/** Make certain headers, day-numbers, week-numbers and time smaller */
.fc th,
.fc-event-time,
.fc-timegrid-axis-cushion,
.fc-timegrid-slot-label-cushion {
	opacity: .8;
	font-size: 80%;
	font-weight: normal;
}

/** Custom styling for events */
.fc-event {
	font-size: 13px;
	line-height: initial;
	padding-left: 3px;
	min-height: 16px;
}

/** Remove top padding from day-number in day-grid view, it's wasting a lot of space */
.fc-daygrid-day-number {
	padding-top: 0 !important;
}

/** Add text-overflow ellipsis for very long event titles */
.fc-daygrid-block-event .fc-event-main {
	text-overflow: ellipsis;
}

/** Make text in day-grid dot events less bold */
.fc-daygrid-dot-event .fc-event-title {
	font-weight: 500 !important;
}
